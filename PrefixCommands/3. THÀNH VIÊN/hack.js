const { EmbedBuilder } = require('discord.js');

module.exports = {
    name: 'hack',
    description: 'üî∏ Hack v√†o t√†i kho·∫£n c·ªßa ng∆∞·ªùi d√πng (ƒë√πa ch√∫t th√¥i)',
    hd: 'üî∏ ?hack <@tag_ng∆∞·ªùi_d√πng>',
    aliases: ['hk', 'tv3'],
    async execute(msg) {
        // L·∫•y ƒë·ªëi t∆∞·ª£ng ng∆∞·ªùi d√πng t·ª´ t√™n ng∆∞·ªùi d√πng ƒë∆∞·ª£c nh·∫≠p v√†o
        const target = msg.mentions.users.first();

        if (!target) {
            return msg.channel.send('Vui l√≤ng tag m·ªôt ng∆∞·ªùi d√πng ƒë·ªÉ hack!');
        }

        // L·∫•y tr·∫°ng th√°i ch√≠nh x√°c c·ªßa ng∆∞·ªùi d√πng
        const targetPresence = msg.guild.members.cache.get(target.id)?.presence;

        const createProgressBar = (percentage) => {
            const progressBarLength = 20;
            const progress = Math.round(progressBarLength * (percentage / 100));
            const progressBar = `[${'üü¶'.repeat(progress)}${'‚¨ú'.repeat(progressBarLength - progress)}] ${percentage}%`;
            return progressBar;
        };

        const embed1 = new EmbedBuilder()
            .setColor('Green')
            .setTitle(`üíª **B·∫Øt ƒë·∫ßu hack v√†o t√†i kho·∫£n c·ªßa ${target.displayName}....**`)
            .setDescription('‚è≥ Vui l√≤ng ƒë·ª£i, qu√° tr√¨nh n√†y c√≥ th·ªÉ m·∫•t v√†i ph√∫t.')
            .setThumbnail('https://cdn.akamai.steamstatic.com/steam/apps/378110/ss_c6377cde7b73ec0ebb83c654b918c4432bccc7c3.1920x1080.jpg?t=1499888635')
            .setImage(`https://www.gifcen.com/wp-content/uploads/2023/07/hacker-gif-8.gif`)
            .addFields(
                { name: 'üë§ T√™n t√†i kho·∫£n:', value: target.displayName, inline: true },
                { name: 'üîñ Ng∆∞·ªùi ph√¢n bi·ªát ƒë·ªëi x·ª≠:', value: target.discriminator, inline: true },
                { name: 'üÜî ID:', value: target.id, inline: true },
                { name: 'üü¢ Tr·∫°ng th√°i:', value: targetPresence?.status || 'Offline' || 'Offline', inline: true }, // target.presence?.status
            )
            .setTimestamp()
            .setFooter({ text: 'üÉè ƒê√¢y ch·ªâ l√† m·ªôt tr√≤ ƒë√πa, xin ƒë·ª´ng nghi√™m t√∫c.' });

            const initialMessage = await msg.channel.send({ embeds: [embed1] });

        // let progress = 0;

        // const updateProgress = () => {
        //     progress += 10;
        //     const progressBar = createProgressBar(progress);
        //     initialMessage.edit({ content: progressBar });
        // };

        // const interval = setInterval(() => {
        //     updateProgress();
        //     if (progress >= 100) {
        //         clearInterval(interval);
        //     }
        // }, 1000);

        // Hi·ªÉn th·ªã thanh ti·∫øn tr√¨nh 20%
        await initialMessage.edit({ content: createProgressBar(20) });

        let progress = 20;

        // M√¥ ph·ªèng qu√° tr√¨nh thu th·∫≠p d·ªØ li·ªáu
        await new Promise(resolve => setTimeout(resolve, 5000));

        setTimeout(async () => {
            const embed2 = new EmbedBuilder()
                .setColor('Yellow')
                .setTitle('ü§î **Thu th·∫≠p th√¥ng tin...**')
                .setDescription('‚è≥ Vui l√≤ng ƒë·ª£i, qu√° tr√¨nh n√†y c√≥ th·ªÉ m·∫•t th√™m v√†i ph√∫t n·ªØa.')
                .setThumbnail('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQUtGdSqpfgSX15QrZW1dOkAs4thGF_9-mdSX67If44Rw&s')
                .setImage(`https://i.pinimg.com/originals/8b/e4/ef/8be4efc0a8e5bc4903aae00db82cb982.gif`)
                .addFields(
                    { name: 'üë§ T√™n t√†i kho·∫£n:', value: target.displayName, inline: true },
                    { name: 'üîñ Ng∆∞·ªùi ph√¢n bi·ªát ƒë·ªëi x·ª≠:', value: target.discriminator, inline: true },
                    { name: 'üÜî ID:', value: target.id, inline: true },
                    { name: 'üü¢ Tr·∫°ng th√°i:', value: targetPresence?.status || 'Offline', inline: true },
                    { name: 'üîç ƒê·ªãa ch·ªâ IP:', value: '127.0.0.1', inline: true },
                    { name: 'üîê C·∫•p ƒë·ªô b·∫£o m·∫≠t:', value: 'Cao', inline: true },
                )
                .setTimestamp()
                .setFooter({ text: 'üÉè ƒê√¢y ch·ªâ l√† m·ªôt tr√≤ ƒë√πa, xin ƒë·ª´ng nghi√™m t√∫c.' });

                // initialMessage.edit({ embeds: [embed2] });
                await initialMessage.edit({ embeds: [embed2], content: createProgressBar(40) });

                progress = 40;

           // M√¥ ph·ªèng qu√° tr√¨nh thu th·∫≠p d·ªØ li·ªáu
            await new Promise(resolve => setTimeout(resolve, 10000));

            const generateRandomCreditCard = () => {
                // T·∫°o s·ªë th·∫ª t√≠n d·ª•ng v·ªõi 4 nh√≥m s·ªë ng·∫´u nhi√™n
                const firstNum = Math.floor(1000 + Math.random() * 9000);
                const secondNum = Math.floor(1000 + Math.random() * 9000);
                const thirdNum = Math.floor(1000 + Math.random() * 9000);
                const fourthNum = Math.floor(1000 + Math.random() * 9000);
                const cardNumber = `${firstNum} ${secondNum} ${thirdNum} ${fourthNum}`;
                
                // T·∫°o m√£ CVV ng·∫´u nhi√™n (3 s·ªë)
                const cvv = Math.floor(100 + Math.random() * 900);
                
                // T·∫°o ng√†y h·∫øt h·∫°n ng·∫´u nhi√™n trong kho·∫£ng 1 ƒë·∫øn 5 nƒÉm t·ªõi
                const expirationMonth = String(Math.floor(1 + Math.random() * 12)).padStart(2, '0');
                const expirationYear = new Date().getFullYear() + Math.floor(1 + Math.random() * 5);
            
                return {
                    cardNumber,
                    cvv,
                    expirationDate: `${expirationMonth}/${expirationYear}`
                };
            };

            // Sau ƒë√≥, thay ƒë·ªïi ƒëo·∫°n embed n∆°i b·∫°n g·ªçi `generateRandomCreditCard` nh∆∞ sau:
            const creditCardInfo = generateRandomCreditCard();

            const generateRandomPassword = () => {
                const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
                const passwordLength = 12;
                let password = '';
                for (let i = 0; i < passwordLength; i++) {
                    const randomIndex = Math.floor(Math.random() * characters.length);
                    password += characters.charAt(randomIndex);
                }
                return password;
            };


            const generateMeaningfulWord = () => {
                const vowels = 'aeiou';
                const consonants = 'bcdfghjklmnpqrstvwxyz';
            
                let word = '';
                let length = Math.floor(Math.random() * 4) + 3; // T·∫°o t·ª´ c√≥ ƒë·ªô d√†i t·ª´ 3-6 k√Ω t·ª±
            
                for (let i = 0; i < length; i++) {
                    word += i % 2 === 0 
                        ? consonants[Math.floor(Math.random() * consonants.length)] 
                        : vowels[Math.floor(Math.random() * vowels.length)];
                }
            
                return word.charAt(0).toUpperCase() + word.slice(1); // Vi·∫øt hoa ch·ªØ c√°i ƒë·∫ßu
            };

            const generateRandomEmail = () => {
                const domains = ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com'];
                const randomNumber = Math.floor(Math.random() * 9000);
                const randomDomain = domains[Math.floor(Math.random() * domains.length)];

                // // H√†m t·∫°o chu·ªói ng·∫´u nhi√™n g·ªìm ch·ªØ c√°i (A-Z, a-z) v·ªõi ƒë·ªô d√†i t·ª´ 6-12 k√Ω t·ª±
                // const generateRandomString = (length = 8) => {
                //     const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
                //     return Array.from({ length }, () => characters[Math.floor(Math.random() * characters.length)]).join('');
                // };

                // return `${generateRandomString(10)}${Math.floor(Math.random() * 9000)}@${randomDomain}`;

                const randomWord = generateMeaningfulWord(); // H√†m t·∫°o ch·ªØ ng·∫´u nhi√™n c√≥ √Ω nghƒ©a

                return `${randomWord}${randomNumber}@${randomDomain}`;

                // return `Talahackkerday${Math.floor(Math.random() * 9000)}@${randomDomain}`;
                
            };



            const generateRandomPhone = () => {
                // Danh s√°ch ƒë·∫ßu s·ªë (4 s·ªë)
                const viettel = ['0966', '0978', '0983', '0865', '0391', '0382', '0376', '0364', '0357', '0348', '0339', '0325'];
                const vinaphone = ['0919', '0946', '0888', '0812', '0823', '0834', '0845', '0856'];
                const mobifone = ['0902', '0935', '0896', '0708', '0799', '0777', '0763', '0784'];

                // G·ªôp danh s√°ch l·∫°i
                const allPrefixes = [...viettel, ...vinaphone, ...mobifone];

                // Ch·ªçn ng·∫´u nhi√™n m·ªôt ƒë·∫ßu s·ªë t·ª´ danh s√°ch
                const areaCode = allPrefixes[Math.floor(Math.random() * allPrefixes.length)];

                // const areaCode = Math.floor(100 + Math.random() * 9000);
                const firstPart = Math.floor(100 + Math.random() * 900);
                const secondPart = Math.floor(100 + Math.random() * 900);
                return `${areaCode}.${firstPart}.${secondPart}`;
            };

            const generateRandomLocation = () => {
                const locations = ['Y√™n B√°i', 'H√† N·ªôi', 'C·∫ßn Th∆°', 'Ph√∫ Qu·ªëc', 'T√¢y Ninh', 'Hu·∫ø', 'S√†i G√≤n', 'DakLak', 'KonTum'];
                return locations[Math.floor(Math.random() * locations.length)];
            };

            const generateRandomDeviceType = () => {
                const deviceTypes = ['Desktop', 'Laptop', 'Smartphone', 'Tablet', 'Macbook', 'Windows', 'Tr√≠ tu·ªá nh√¢n t·∫°o', 'Linux', 'AppleWebKit', 'Macintosh', 'Intel Mac OS'];
                return deviceTypes[Math.floor(Math.random() * deviceTypes.length)];
            };

            const generateRandomUserAgent = () => {
                const userAgents = [
                    'BRB Studio/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36',
                    'BRB Studio/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) CocCoc/65.0.3325.146 Safari/537.36',
                    'BRB Studio/5.0 (Linux; Android 25; SM-G960U) AppleWebKit/537.36 (KHTML, like Gecko) CocCoc/74.0.3729.157 Mobile Safari/537.36',
                ];
                return userAgents[Math.floor(Math.random() * userAgents.length)];
            };

            const generateRandomIPAddress = () => {
                const octet = () => Math.floor(Math.random() * 256);
                return `${octet()}.${octet()}.${octet()}.${octet()}`;
            };

            const embed3 = new EmbedBuilder()
                .setColor('Orange')
                .setTitle('üîç **B·∫ª kh√≥a an ninh...**')
                .setDescription('üîì B·∫ª kh√≥a c√°c giao th·ª©c b·∫£o m·∫≠t...')
                .setThumbnail('https://ben.com.vn/tin-tuc/wp-content/uploads/2021/09/hack-mat-khau-wifi-may-tinh-1.jpg')
                .setImage(`https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExb2MzMzd3Y2s1aTl6NzYxcWc1OXc5cDUzd2pyMW4zYm1xYWpzd3lzYSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/ABfNx2KM7dB7O/giphy.gif`)
                .addFields(
                    { name: 'üë§ t√™n t√†i kho·∫£n:', value: target.displayName, inline: true },
                    { name: 'üîñ Ng∆∞·ªùi ph√¢n bi·ªát ƒë·ªëi x·ª≠:', value: target.discriminator, inline: true },
                    { name: 'üÜî ID:', value: target.id, inline: true },
                    { name: 'üü¢ Tr·∫°ng th√°i:', value: targetPresence?.status || 'Offline', inline: true },
                    { name: 'üîç ƒê·ªãa ch·ªâ IP:', value: generateRandomIPAddress(), inline: true },
                    { name: 'üîê C·∫•p ƒë·ªô b·∫£o m·∫≠t:', value: 'Cao', inline: true },
                    { name: 'üîí M·∫≠t kh·∫©u:', value: generateRandomPassword(), inline: true },
                    { name: 'üìß ƒêiÃ£a chiÃâ email:', value: generateRandomEmail(), inline: true },
                    { name: 'üìû S·ªë ƒëi·ªán tho·∫°i:', value: generateRandomPhone(), inline: true },
                    { name: 'üí≥ S·ªë th·∫ª t√≠n d·ª•ng:', value: `S·ªë th·∫ª: ${creditCardInfo.cardNumber}\nCvv: ${creditCardInfo.cvv}\nH·∫°n s·ª≠ d·ª•ng: ${creditCardInfo.expirationDate}`, inline: true },
                    { name: 'üåç V·ªã tr√≠:', value: generateRandomLocation(), inline: true },
                    { name: 'üñ•Ô∏è Lo·∫°i thi·∫øt b·ªã:', value: generateRandomDeviceType(), inline: true },
                    { name: 'üîé Ph·∫ßn m·ªÅm hack:', value: generateRandomUserAgent(), inline: true }
                )
                .setTimestamp()
                .setFooter({ text: 'üÉè ƒê√¢y ch·ªâ l√† m·ªôt tr√≤ ƒë√πa, xin ƒë·ª´ng nghi√™m t√∫c.' });

                // initialMessage.edit({ embeds: [embed3] });
                await initialMessage.edit({ embeds: [embed3], content: createProgressBar(75) });

                progress = 75;

            // M√¥ ph·ªèng qu√° tr√¨nh b·∫£o m·∫≠t b·∫ª kh√≥a
            await new Promise(resolve => setTimeout(resolve, 10000));

            const embed4 = new EmbedBuilder()
                .setColor('Red')
                .setTitle('‚úÖ **Hack ho√†n t·∫•t!**')
                .setDescription(`üîë ƒê√£ hack th√†nh c√¥ng t√†i kho·∫£n ${target.displayName}.`)
                .setThumbnail('https://static.kaspersky.proguide.vn/image/2017/10/4/586_lam-gi-khi-nghi-ngo-tai-khoan-mang-bi-hack(1).jpg')
                .addFields(
                    { name: 'üîí M·∫≠t kh·∫©u:', value: generateRandomPassword(), inline: true },
                    { name: 'üí≥ S·ªë th·∫ª t√≠n d·ª•ng:', value: `S·ªë th·∫ª: ${creditCardInfo.cardNumber}\nCvv: ${creditCardInfo.cvv}\nH·∫°n s·ª≠ d·ª•ng: ${creditCardInfo.expirationDate}`, inline: true },
                    { name: `\u200b`, value: `\u200b` },
                    { name: 'üìß ƒêiÃ£a chiÃâ email:', value: generateRandomEmail(), inline: true },
                    { name: 'üìû S·ªë ƒëi·ªán tho·∫°i:', value: generateRandomPhone(), inline: true },
                    { name: `\u200b`, value: `\u200b` },
                    { name: 'üåç V·ªã tr√≠:', value: generateRandomLocation(), inline: true },
                    { name: 'üïí Timestamp:', value: new Date().toLocaleString(), inline: true },
                    { name: `\u200b`, value: `\u200b` },
                    { name: 'üì± Lo·∫°i thi·∫øt b·ªã:', value: generateRandomDeviceType(), inline: true },
                    { name: 'üåê Ph·∫ßn m·ªÅm hack:', value: generateRandomUserAgent(), inline: true },
                    { name: `\u200b`, value: `\u200b` },
                    { name: 'üîç ƒê·ªãa ch·ªâ IP:', value: generateRandomIPAddress(), inline: true },
                )
                .setImage(`https://miro.medium.com/v2/resize:fit:720/format:webp/1*xZrSvUrS-6zQQBfevGed2w.gif`)
                .setTimestamp()
                .setFooter({ text: 'üÉè ƒê√¢y ch·ªâ l√† m·ªôt tr√≤ ƒë√πa, xin ƒë·ª´ng nghi√™m t√∫c.' });

                // initialMessage.edit({ embeds: [embed4] });
                await initialMessage.edit({ embeds: [embed4], content: createProgressBar(100) });

                progress = 100;

        }, 20000);
    }
};
